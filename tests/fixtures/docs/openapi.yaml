openapi: '3.0.3'

info:
  title: Test API
  description: A test API for documentation builder tests.
  version: '1.0.0'

servers:
  - url: http://localhost:8000/api/v1
    description: Local development

tags:
  - name: Authentication
    description: Auth endpoints
  - name: User
    description: User management

paths:
  /auth/register:
    post:
      tags:
        - Authentication
      operationId: registerUser
      summary: Register a new user
      description: Creates a new user account and returns an authentication token.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - email
                - password
                - password_confirmation
                - device_name
              properties:
                name:
                  type: string
                  description: The user's full name
                  example: John Doe
                email:
                  type: string
                  format: email
                  description: The user's email address
                  example: john@example.com
                password:
                  type: string
                  format: password
                  description: The user's password
                  example: secret123
                password_confirmation:
                  type: string
                  format: password
                  description: Password confirmation
                  example: secret123
                device_name:
                  type: string
                  description: The device name for the token
                  example: iPhone 15
      responses:
        '201':
          description: User created successfully
          content:
            application/json:
              example:
                data:
                  id: 1
                  name: John Doe
                  email: john@example.com
                token: 1|abc123
        '422':
          description: Validation error

  /auth/login:
    post:
      tags:
        - Authentication
      operationId: loginUser
      summary: Login
      description: Authenticates a user and returns a token.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
                - device_name
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  format: password
                device_name:
                  type: string
      responses:
        '200':
          description: Login successful
        '401':
          description: Invalid credentials

  /auth/logout:
    post:
      tags:
        - Authentication
      operationId: logoutUser
      summary: Logout
      description: Revokes the current authentication token.
      security:
        - bearerAuth: []
      responses:
        '204':
          description: Logged out successfully

  /user:
    get:
      tags:
        - User
      operationId: getCurrentUser
      summary: Get current user
      description: Returns the currently authenticated user's profile.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: User profile
          content:
            application/json:
              example:
                data:
                  id: 1
                  name: John Doe
                  email: john@example.com

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: Sanctum
